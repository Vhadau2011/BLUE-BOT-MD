const a64_0x315bd0=a64_0x4d34;(function(_0x4b5119,_0x3f2e79){const _0xa1bce4=a64_0x4d34,_0x417f9f=_0x4b5119();while(!![]){try{const _0x15e9c4=parseInt(_0xa1bce4(0x1ff))/0x1*(parseInt(_0xa1bce4(0x212))/0x2)+-parseInt(_0xa1bce4(0x21d))/0x3+-parseInt(_0xa1bce4(0x215))/0x4*(-parseInt(_0xa1bce4(0x1f1))/0x5)+parseInt(_0xa1bce4(0x1f2))/0x6*(-parseInt(_0xa1bce4(0x214))/0x7)+parseInt(_0xa1bce4(0x1fa))/0x8*(-parseInt(_0xa1bce4(0x1d0))/0x9)+-parseInt(_0xa1bce4(0x1db))/0xa*(-parseInt(_0xa1bce4(0x1f9))/0xb)+parseInt(_0xa1bce4(0x209))/0xc*(parseInt(_0xa1bce4(0x1f4))/0xd);if(_0x15e9c4===_0x3f2e79)break;else _0x417f9f['push'](_0x417f9f['shift']());}catch(_0x18cc58){_0x417f9f['push'](_0x417f9f['shift']());}}}(a64_0x6f34,0xd362f));function a64_0x4d34(_0x457913,_0x482a4f){const _0x29c768=a64_0x6f34();return a64_0x4d34=function(_0x4d51e0,_0x523ce4){_0x4d51e0=_0x4d51e0-0x1ca;let _0x6f340a=_0x29c768[_0x4d51e0];if(a64_0x4d34['BYTeNY']===undefined){var _0x4d344d=function(_0x375333){const _0x5a601b='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x504ff1='',_0x1ebb86='',_0x1c4662=_0x504ff1+_0x4d344d;for(let _0x253fcf=0x0,_0x152436,_0x290e30,_0x553b60=0x0;_0x290e30=_0x375333['charAt'](_0x553b60++);~_0x290e30&&(_0x152436=_0x253fcf%0x4?_0x152436*0x40+_0x290e30:_0x290e30,_0x253fcf++%0x4)?_0x504ff1+=_0x1c4662['charCodeAt'](_0x553b60+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0x152436>>(-0x2*_0x253fcf&0x6)):_0x253fcf:0x0){_0x290e30=_0x5a601b['indexOf'](_0x290e30);}for(let _0x3f784b=0x0,_0x34b776=_0x504ff1['length'];_0x3f784b<_0x34b776;_0x3f784b++){_0x1ebb86+='%'+('00'+_0x504ff1['charCodeAt'](_0x3f784b)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x1ebb86);};a64_0x4d34['urYgQK']=_0x4d344d,_0x457913=arguments,a64_0x4d34['BYTeNY']=!![];}const _0x2aa288=_0x29c768[0x0],_0x2ff9e8=_0x4d51e0+_0x2aa288,_0x18aab4=_0x457913[_0x2ff9e8];if(!_0x18aab4){const _0x580c43=function(_0x2eb38c){this['LXzoSL']=_0x2eb38c,this['meeJkQ']=[0x1,0x0,0x0],this['YGbcdZ']=function(){return'newState';},this['tHcLKV']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['XZdTYf']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x580c43['prototype']['NvLpDW']=function(){const _0x3df7e3=new RegExp(this['tHcLKV']+this['XZdTYf']),_0x216971=_0x3df7e3['test'](this['YGbcdZ']['toString']())?--this['meeJkQ'][0x1]:--this['meeJkQ'][0x0];return this['QXfWto'](_0x216971);},_0x580c43['prototype']['QXfWto']=function(_0x415ac4){if(!Boolean(~_0x415ac4))return _0x415ac4;return this['EDzMMl'](this['LXzoSL']);},_0x580c43['prototype']['EDzMMl']=function(_0x335c08){for(let _0xa1929a=0x0,_0x2b9bf8=this['meeJkQ']['length'];_0xa1929a<_0x2b9bf8;_0xa1929a++){this['meeJkQ']['push'](Math['round'](Math['random']())),_0x2b9bf8=this['meeJkQ']['length'];}return _0x335c08(this['meeJkQ'][0x0]);},new _0x580c43(a64_0x4d34)['NvLpDW'](),_0x6f340a=a64_0x4d34['urYgQK'](_0x6f340a),_0x457913[_0x2ff9e8]=_0x6f340a;}else _0x6f340a=_0x18aab4;return _0x6f340a;},a64_0x4d34(_0x457913,_0x482a4f);}const a64_0x523ce4=(function(){const _0x4ffc02={'aayuh':function(_0x5208f4,_0x4e14ad){return _0x5208f4!==_0x4e14ad;},'lMFIq':'ynMLl'};let _0x5ba908=!![];return function(_0xc2bf21,_0x283d33){const _0x48dfb5=a64_0x4d34,_0x3948c6={'ZRKZf':_0x48dfb5(0x21f),'Xcbem':function(_0x2b69b7,_0x490945){const _0x2f80b2=_0x48dfb5;return _0x4ffc02[_0x2f80b2(0x1ee)](_0x2b69b7,_0x490945);},'Sqhao':_0x4ffc02[_0x48dfb5(0x20f)]};if(_0x48dfb5(0x1e3)!==_0x48dfb5(0x1e3)){if(_0x5d0176){const _0x41bda5=_0x16ce72['apply'](_0x4b46cd,arguments);return _0x5bdce5=null,_0x41bda5;}}else{const _0xa9e7a4=_0x5ba908?function(){const _0x26f279=_0x48dfb5;if(_0x26f279(0x201)!==_0x3948c6[_0x26f279(0x1cf)]){if(_0x283d33){if(_0x3948c6['Xcbem'](_0x3948c6[_0x26f279(0x1ed)],'UuHYh')){const _0x2c4757=_0x283d33[_0x26f279(0x1d8)](_0xc2bf21,arguments);return _0x283d33=null,_0x2c4757;}else return _0x20ee46(_0x26f279(0x20a)+_0x5dde35+'\x20is\x20not\x20valid.\x20Valid\x20actions\x20are:\x20'+_0xf8aea1['values'](this[_0x26f279(0x1e4)])[_0x26f279(0x203)](',\x20'));}}else return _0x414968[_0x26f279(0x210)]('Error\x20setting\x20'+_0x21ad33+_0x26f279(0x21e)+_0x161ca4+':\x20'+_0x322b08),_0x4f80ac(_0x26f279(0x1d2));}:function(){};return _0x5ba908=![],_0xa9e7a4;}};}()),a64_0x4d51e0=a64_0x523ce4(this,function(){const _0x33f4e6=a64_0x4d34,_0x478791={'TrpMc':_0x33f4e6(0x216)};return a64_0x4d51e0['toString']()[_0x33f4e6(0x1ea)](_0x33f4e6(0x216))[_0x33f4e6(0x202)]()[_0x33f4e6(0x1de)](a64_0x4d51e0)[_0x33f4e6(0x1ea)](_0x478791[_0x33f4e6(0x205)]);});a64_0x4d51e0();const NodeCache=require(a64_0x315bd0(0x1d1)),{DB}=require(a64_0x315bd0(0x20d)),{bluebot-md}=require('../bluebot-md'),{DataTypes,Model}=require(a64_0x315bd0(0x204));function a64_0x6f34(){const _0x30a8d1=['zxrHDa','yxbWBhK','D2fYBG','u2jxzgu','nJa5ntCWDM9VuKz6','vgHLigfJDgLVBIbMB3iG','rxjYB3iGy2HLy2TPBMCGzw5HyMXLzcbZDgf0zsbMB3iGAMLKia','y29UC3rYDwn0B3i','zw5HyMXLza','zgvMAw5L','vvbuD2y','ywn0Aw9UlW','DfvYv08','qunusu9ouW','t1bhr1u','ww91igrVig5VDcbOyxzLihrOzsbUzwnLC3nHCNKGCgvYBwLZC2LVBNm','rxjYB3iGz2v0DgLUzYbHy3rPB24GzM9YigPPzca','u1rbvevt','kGOk4OcIicO','C2vHCMnO','DxbZzxj0','x2LUAxq','u3fOyw8','ywf5DwG','kIdINQhVUi8Gx0fJDgLVBJPFiokAOo+4JYbezwXLDguk4OcIicO','igfJDgLVBI8','mJK1y3nJAxf6','mJe2nK15wMz5yW','zvjwEgS','otq2nZLdvLP5zM8','C3rHCNrZv2L0Aa','r2DUteG','C3LUyW','Dvv1Dwm','mJa5rhHYue54','mJy0ofjty3rMwG','CMvTB3zL','rxjYB3iGDxbKyxrPBMCGAMLKia','wKH4ue4','Aw5JBhvKzxm','mtq0vwTJtxnv','z2vUzxjHDgvdBwq','r1HXwuG','Dg9tDhjPBMC','AM9PBG','C2vXDwvSAxPL','vhjWtwm','tK9sAKu','rxjYB3iGC2v0DgLUzYa','ihDPDgGGywn0Aw9Uia','otG0u2vsB09S','vgHLigfJDgLVBIa','zw5HyMXLzezVCKPPza','rwH0Afa','lI4VlI4VyMrKl19PBMrLEa','z0DRBgu','Be1gsxe','Bg9N','vNfWt2e','mJeZmdHLy05Ls1G','zgLZywjSzwq','mteWmZL5t1POs1m','nZiWne5TEg9zCa','kcGOlISPkYKRksSK','u1rssu5h','AxrXrK8','kIdINQhVUi8Gx3rVigvUywjSzsb0AguGzMvHDhvYzv8G4PYfcUkaOIaQ','ywn0Aw9U','kIdINQhVUi8Gx3rVigrPC2fIBguGAxrFiokDJaOk4PQz77IpicPdAgfUz2uGDgHLigfJDgLVBIO6cUkaOIaQ','vgHPCYbJB21Tyw5KigLZig9UBhKGyxzHAwXHyMXLigzVCIbNCM91Chm','mJa1nJaZnvntugLYsW','igzVCIbQAwqG','BNrdteu','zMLUzej5ugS','zxjYB3i','z2v0','DgvXyu0','igLZig5VDYbKAxnHyMXLza','DMfSDwvZ','wLjlwMy','mZq2nZDRwg5eA2K','BM9Kzs1JywnOzq','qw4GzxjYB3iGB2nJDxjYzwqSihbSzwfZzsbSzxqGDxmGA25VDYbVBIb0AguGzM9YDw0GAwyGCgvYC2LZDgvUDa','C3bSAxq','Dg9mB3DLCKnHC2u','C2v0','igLZigfSCMvHzhKGzw5HyMXLza'];a64_0x6f34=function(){return _0x30a8d1;};return a64_0x6f34();}class EventStateManager{#tableName;#db=null;['_init']=null;[a64_0x315bd0(0x1e8)]={'enabled':'on','disabled':'off'};[a64_0x315bd0(0x1e4)]={'remove':a64_0x315bd0(0x1fb),'delete':'delete','warn':a64_0x315bd0(0x1d9)};#defaultAction=this[a64_0x315bd0(0x1e4)][a64_0x315bd0(0x1fb)];#defaultState=this[a64_0x315bd0(0x1e8)][a64_0x315bd0(0x213)];#cache;constructor(_0x5e5245,_0x41ea64=new NodeCache()){this.#tableName=_0x5e5245,this.#cache=_0x41ea64,this['_init']=this.#createTable();}async #createTable(){const _0x1af631=a64_0x315bd0;this.#db=DB[_0x1af631(0x1e0)](this.#tableName,{'jid':{'type':DataTypes[_0x1af631(0x217)],'primaryKey':!![]},'etat':{'type':DataTypes[_0x1af631(0x217)],'defaultValue':this.#defaultState},'action':{'type':DataTypes[_0x1af631(0x217)],'defaultValue':this.#defaultAction}}),await this.#db[_0x1af631(0x1f7)]();}async #addOrUpdateJid(_0x25b1c1,_0x377ed5=this.#defaultState){const _0x3cfaa0=a64_0x315bd0;await this['_init'],await this.#db[_0x3cfaa0(0x1eb)]({'jid':_0x25b1c1,'etat':_0x377ed5});const _0x4ec031=this.#cache['get'](_0x25b1c1)||{};this.#cache['set'](_0x25b1c1,{..._0x4ec031,'etat':_0x377ed5});}async #updateJidAction(_0x49c1c3,_0x306c8c=this.#defaultAction){const _0x474783=a64_0x315bd0,_0x4014e5={'cPOSA':function(_0x5293bc,_0x3cd306){return _0x5293bc===_0x3cd306;},'gGkle':'KwCNd'};try{await this[_0x474783(0x1ec)],await this.#db[_0x474783(0x1eb)]({'jid':_0x49c1c3,'action':_0x306c8c});const _0xd62575=this.#cache['get'](_0x49c1c3)||{};this.#cache['set'](_0x49c1c3,{..._0xd62575,'action':_0x306c8c});}catch(_0x238323){if(_0x4014e5['cPOSA'](_0x4014e5[_0x474783(0x20e)],'KwCNd')){console[_0x474783(0x1ca)]('Error\x20updating\x20jid\x20'+_0x49c1c3+'\x20with\x20action\x20'+_0x306c8c+':',_0x238323);throw _0x238323;}else return _0x724718['toString']()[_0x474783(0x1ea)](_0x474783(0x216))[_0x474783(0x202)]()[_0x474783(0x1de)](_0xb634fa)[_0x474783(0x1ea)](_0x474783(0x216));}}async[a64_0x315bd0(0x20b)](_0x47b237){const _0x1c4618=a64_0x315bd0,_0x1fe5ff={'cnERg':function(_0x25b34a,_0x5aa58c){return _0x25b34a!==_0x5aa58c;}};try{const _0x2b199b=this.#cache['get'](_0x47b237);if(_0x1fe5ff['cnERg'](_0x2b199b?.['etat'],undefined))return _0x2b199b[_0x1c4618(0x1d7)]!==this.#defaultState;await this[_0x1c4618(0x1ec)];const _0x1ab07d=await this.#db['findByPk'](_0x47b237);if(_0x1ab07d){const _0x2a5a77=_0x1ab07d[_0x1c4618(0x1cb)]({'plain':!![]});return this.#cache[_0x1c4618(0x1d5)](_0x47b237,{...this.#cache[_0x1c4618(0x1cb)](_0x47b237)||{},'etat':_0x2a5a77[_0x1c4618(0x1d7)]}),_0x2a5a77['etat']!==this.#defaultState;}return![];}catch(_0x5efabc){if(_0x1fe5ff['cnERg'](_0x1c4618(0x1f6),_0x1c4618(0x20c)))return console['error'](_0x1c4618(0x1dd)+_0x47b237+':',_0x5efabc),![];else{_0x1c0a8c[_0x1c4618(0x1ca)](_0x1c4618(0x1fc)+_0x329cd0+_0x1c4618(0x208)+_0x2832c2+':',_0x3a5b48);throw _0x3fd55c;}}}async['getActionForJid'](_0x396bc5){const _0x3e8e87=a64_0x315bd0;try{const _0x881eaa=this.#cache[_0x3e8e87(0x1cb)](_0x396bc5);if(_0x881eaa?.[_0x3e8e87(0x21a)])return _0x881eaa[_0x3e8e87(0x21a)];await this[_0x3e8e87(0x1ec)];const _0x2c7358=await this.#db[_0x3e8e87(0x220)](_0x396bc5);if(_0x2c7358){const _0x30a42a=_0x2c7358[_0x3e8e87(0x1cb)]({'plain':!![]});return this.#cache[_0x3e8e87(0x1d5)](_0x396bc5,{...this.#cache[_0x3e8e87(0x1cb)](_0x396bc5)||{},'action':_0x30a42a['action']}),_0x30a42a[_0x3e8e87(0x21a)];}return this.#defaultAction;}catch(_0x36edec){console[_0x3e8e87(0x1ca)](_0x3e8e87(0x1e7)+_0x396bc5+':',_0x36edec);throw _0x36edec;}}[a64_0x315bd0(0x200)](_0x5caad3){const _0x5e2e98=a64_0x315bd0,_0x81322d={'NORjE':_0x5e2e98(0x1e6),'UPTwf':function(_0x149952,_0x165335){return _0x149952(_0x165335);},'ZHxPN':function(_0x5e9ff3,_0x483265){return _0x5e9ff3(_0x483265);},'VqpOa':function(_0x2cb661,_0x4c0363){return _0x2cb661!==_0x4c0363;},'uUuuc':'eRVxk','SbWde':_0x5e2e98(0x1e2),'itqFO':function(_0x2f1e3b,_0x5d2b97){return _0x2f1e3b===_0x5d2b97;}},{nomCom:_0x393eba}=_0x5caad3;bluebot-md({..._0x5caad3},async(_0x12cb45,_0x17b77b,_0x576f60)=>{const _0x820917=_0x5e2e98,{verifGroupe:_0x122b83,verifAdmin:_0x1752a3,ms:_0x2b26d8,arg:_0x2ba05d,superUser:_0xbc9d1b,repondre:_0x1c43e1}=_0x576f60;if(!_0x122b83)return _0x81322d[_0x820917(0x1e1)](_0x1c43e1,_0x820917(0x21c));if(!_0xbc9d1b&&!_0x1752a3)return _0x1c43e1(_0x81322d['NORjE']);try{const _0x40a439='\x0aüõ†Ô∏è\x20*Configuration\x20of\x20'+_0x393eba+_0x820917(0x1e9)+_0x393eba+'\x20'+this['STATES']['enabled']+_0x820917(0x219)+_0x393eba+'\x20'+this['STATES']['disabled']+_0x820917(0x21b)+_0x393eba+'\x20action/'+this[_0x820917(0x1e4)]['remove']+'*\x20‚û°Ô∏è\x20_Action:_\x20üóëÔ∏è\x20Remove\x0a‚Ä¢\x20*'+_0x393eba+_0x820917(0x1f0)+this[_0x820917(0x1e4)]['delete']+_0x820917(0x1ef)+_0x393eba+_0x820917(0x1f0)+this['ACTIONS'][_0x820917(0x1d9)]+'*\x20‚û°Ô∏è\x20_Action:_\x20üîî\x20Warn';if(!_0x2ba05d||!_0x2ba05d[0x0]||_0x2ba05d[_0x820917(0x203)]('')['trim']()=='')return _0x81322d['ZHxPN'](_0x1c43e1,_0x40a439);const _0x58bf=_0x2ba05d[0x0][_0x820917(0x1d4)]();if(_0x58bf==this[_0x820917(0x1e8)][_0x820917(0x1df)]){if(_0x81322d[_0x820917(0x211)](_0x820917(0x1f3),_0x81322d[_0x820917(0x1f8)])){_0x5baf40['error']('Error\x20getting\x20action\x20for\x20jid\x20'+_0x3a947c+':',_0x1c2ad6);throw _0x55c188;}else{if(await this[_0x820917(0x20b)](_0x12cb45))return _0x1c43e1(_0x393eba+_0x820917(0x1d6));return await this.#addOrUpdateJid(_0x12cb45,_0x58bf),_0x1c43e1(_0x393eba+'\x20is\x20now\x20enabled');}}else{if(_0x58bf==this[_0x820917(0x1e8)]['disabled']){if(!await this['enabledForJid'](_0x12cb45))return _0x1c43e1(_0x393eba+'\x20is\x20already\x20disabled');return await this.#addOrUpdateJid(_0x12cb45,_0x58bf),_0x1c43e1(_0x393eba+_0x820917(0x1cd));}else{if(_0x58bf[_0x820917(0x1f5)](_0x81322d[_0x820917(0x1da)])){const _0x3061de=_0x58bf[_0x820917(0x1d3)]('/')[0x1]['trim']()[_0x820917(0x1d4)]();if(!Object['values'](this['ACTIONS'])[_0x820917(0x1fe)](_0x3061de))return _0x1c43e1(_0x820917(0x20a)+_0x3061de+'\x20is\x20not\x20valid.\x20Valid\x20actions\x20are:\x20'+Object[_0x820917(0x1ce)](this['ACTIONS'])['join'](',\x20'));return await this.#updateJidAction(_0x12cb45,_0x3061de),_0x81322d[_0x820917(0x1fd)](_0x1c43e1,_0x820917(0x1dc)+_0x393eba+'\x20is\x20now\x20'+_0x3061de);}else return _0x1c43e1(_0x40a439);}}}catch(_0x45b841){return _0x81322d[_0x820917(0x218)](_0x820917(0x1cc),_0x820917(0x1e5))?_0x299f81(_0x81322d[_0x820917(0x206)]):(console['log'](_0x820917(0x207)+_0x393eba+_0x820917(0x21e)+_0x12cb45+':\x20'+_0x45b841),_0x1c43e1(_0x820917(0x1d2)));}});}}module['exports']=EventStateManager;